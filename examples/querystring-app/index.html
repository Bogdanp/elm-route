<html>
  <head>
    <title>Route Example</title>
    <script src="/elm.js"></script>
  </head>
  <body>
    <script>
      var app = Elm.fullscreen(Elm.Main, {
        path: window.location.pathname + window.location.search,
        search: window.location.search
      });

      function sendSearch() {
        app.ports.search.send(window.location.search);
      }

      var pushState = window.history.pushState;
      window.history.pushState = function(state, title, url) {
        var result = pushState.call(window.history, state, title, url);
        sendSearch();
        return result;
      };

      window.onpopstate = sendSearch;
    </script>
  </body>
</html>
